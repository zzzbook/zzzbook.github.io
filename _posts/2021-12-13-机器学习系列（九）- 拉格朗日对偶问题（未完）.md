---
layout: post
title: 机器学习系列（九）- 拉格朗日对偶问题
date: 2021-12-13
categories: 机器学习系列
tags: 研究生 机器学习

---

# 机器学习系列（九）- 拉格朗日对偶问题

- 视频参考：[“拉格朗日对偶问题”如何直观理解？“KKT条件” “Slater条件” “凸优化”打包理解](https://www.bilibili.com/video/BV1HP4y1Y79e)
- 视频参考：[机器学习之凸优化](https://www.bilibili.com/video/BV1es411u7pK?p=28)

## 拉格朗日乘数法

- 拉格朗日乘数法主要解决当**存在约束条件时，求函数的最值**。

- **定义: **其中 $\lambda_i$ 称为拉格朗日乘子

  $\begin{align} min & \enspace f_0(x),x\in\mathbb{R} \newline s.t. & \enspace f_i(x) \le 0,其中i=1,2,3,...,m\end{align} \Rightarrow L(x,y)=f_0(x)+\sum\lambda_i f_i(x)$ 

- 拉格朗日函数与梯度的关系

  定义函数：$\begin{align} & minf(x),x\in\mathbb{R}^n \newline & s.t. \enspace g_i(x)=a_i^T·x+b \le 0,其中i=1,2,3,...,m;a_i\in\mathbb{R}^n;b_i\in\mathbb{R} \end{align}$ ，设约束条件如图所示；

  <img src="http://markdown.zzzbook.cn/image-20211213141044821.png" alt="image-20211213141044821" style="zoom:40%;" />

  1. 拉格朗日乘子式：$L(x,\lambda)=f(x)+\sum\lambda_ig_i(x)$ 

  2. 导数求极值点：$\nabla L(x,\lambda)=0\Rightarrow-\nabla f(x)=\sum\lambda_i·\nabla g_i(x)$ 

  3. 由图可知最优解在点 $x^*$ 处，为约束条件 $\nabla g_\alpha(x^*)$ 与 $\nabla g_\beta(x^*)$ 构成直线的交点；且橙色区域为约束条件区域，区域内 $\le0$ ；

     则 $g_\alpha(x^*)=g_\beta(x^*)=0$ 

  4. 最优梯度为垂直于约束条件 $\nabla g_\alpha(x^*)$ 与 $\nabla g_\beta(x^*)$ 向量在点 $x^*$ 处的和的反方向；

     则 $\lambda_\alpha·\nabla g_\alpha(x^*)+\lambda_\beta·\nabla g_\beta(x^*)=-\nabla f(x)$ 

     又因最优梯度不为 $0$，且 $g_\alpha(x^*)=g_\beta(x^*)=0$ ，则可推导 $\lambda_\alpha,\lambda_\beta\ne 0$ 

  5. 其它约束条件 $g_i(x^*)<0$ ，则可推导 $\lambda _i·\nabla g_i(x)=0\Rightarrow \lambda_i=0(i\ne \alpha,\beta)$ 

     对于所有的 $\lambda_i\ge0,\begin{cases}\lambda_i=0,&g_i(x)松弛 \newline \lambda_i>0,&g_i(x)紧致(发挥作用) \end{cases}$ 

## 基础定义

### 凸问题

- 通过拉格朗日乘数法求导所得可能为极值点或鞍点，而非最值点；但在**凸问题**的情况下，极值点即为最值点；
- “凸问题”对应“非凸问题”，而非“凹问题”；

### 凸集

- **凸集**定义：$\forall x_1,x_2\in C,0\le\theta\le1 \Rightarrow \theta·x_1+(1-\theta)·x_2\in C$ 

  即在集合内任意两点，两点连线上的任意点也在集合内部，则为凸集；

- **仿射集**定义：$\forall x_1,x_2\in C,\theta\in\mathbb{R} \Rightarrow \theta·x_1+(1-\theta)·x_2\in C$ 

  变型可得：$x\in\mathbb{R},W\in\mathbb{R},b\in\mathbb{R},C=\{x|W^T·x+b=0\}$ 

  则 $C$ 为仿射集，仿射集为凸集；直线、平面、三维坐标系，均为仿射集（无限延展）；

- **半空间**定义：$W\in\mathbb{R},b\in\mathbb{R},C=\{x|W^T·x+b\le 0\}$ 

  则 $C$ 为半空间，半空间为凸集；（直线切割平面）

### 凸函数

- “凸函数”开口朝上，存在最小值；“凹函数”则与之相反，存在最大值；（与直观理解概念相反）

  <img src="http://markdown.zzzbook.cn/image-20211213161710748.png" alt="image-20211213161710748" style="zoom:45%;" />

## 拉格朗日函数对偶问题

### **对偶问题推导**

1. 定义初始问题：

   $\begin{align} min & \enspace f_0(x),x\in\mathbb{R} \newline s.t. & \begin{cases} \enspace f_i(x) \le 0,其中i=1,2,3,...,m \newline \enspace h_i(x) = 0,其中i=1,2,3,...,q \end{cases} \end{align}$ 

2. 拉格朗日乘数式：$L(x,\lambda,\nu)=f_0(x)+\sum\lambda_i f_i(x)+\sum \nu_i h_i(x)$ 

   定义原问题：$\begin{align} & min_{x}max_{\lambda,\nu}L(x,\lambda,\nu) \newline & s.t. \lambda\ge0 \end{align}$ 

   **初始问题与原问题等价证明：**

   - 将约束条件融入式中后，则该式 $x$ 可任取值；则存在情况：

     $\begin{align}  & min_x\begin{cases} x不在初始问题可行域内:max_{\lambda,\nu}L(x,\lambda,\nu)=f_0(x)+\infty+\infty \newline x在初始问题可行域内:max_{\lambda,\nu}L(x,\lambda,\nu)=f_0(x)+0+0 \end{cases} \newline \Rightarrow & min_x max_{\lambda,\nu}L(x,\lambda,\nu) = min_x\{\infty,f_0(x)\} = minf_0(x) \end{align}$ 

3. 对偶函数：$g(\lambda,\nu)=min_{x}L(x,\lambda,\nu)$

   对偶问题：$\begin{align} & max_{\lambda,\nu}g(\lambda,\nu)=max_{\lambda,\nu}min_{x}L(x,\lambda,\nu) \newline & s.t. \lambda\ge0 \end{align}$ 

### 对偶问题性质

- 拉格朗日函数的对偶问题，对偶函数一定是凹函数，凸优化问题

  - **凸优化问题**：对应问题函数为凸函数，可行域为凸集；

  - 函数 $g(\lambda,\nu)$ 为一条直线，既是凸函数，又是凹函数；因求 $max\enspace g(\lambda,\nu)$，则认为是凹函数；则可知求 $max \Rightarrow -min$ ，则函数为凸函数；

    又因 $\lambda\ge 0$ ，则可行域为半空间，半空间为凸集；

    故对偶问题一定是凸优化问题；

### 原问题与对偶问题等价性









