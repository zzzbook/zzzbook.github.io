---
layout: post
title: 机器学习系列（五）- 交叉熵
date: 2021-10-13
categories: 机器学习系列
tags: 研究生 机器学习

---

# 机器学习系列（五）- 交叉熵

- 视频参考：[“交叉熵”如何做损失函数？打包理解“信息量”、“比特”、“熵”、“KL散度”、“交叉熵”](https://www.bilibili.com/video/BV15V411W7VB)

## 基础概念

- **公度**：不可直接进行比对的量，转换为同度量单位。在神经网络中，当两个模型不同时无法直接进行比对，则将模型转换为统一度量—“熵”。
- **熵**：表示一个系统中的不确定性的值。
- **信息量**：消除系统中不确定性的量。

## 定义信息量

- **推导过程**

  1. 定义信息量 $f(p(x))$ ，假定 $x$ 为最终结果， $x_1,x_2$ 为独立的前置条件；

  2. 则存在信息量 $f(p(x))=f(p(x_1))+f(p(x_2))$ ；

  3. 根据概率定义 $p(x)=p(x_1)·p(x_2)=p(x_1x_2)$ ；

  4. 通过公式转换，结果为 $f(p(x_1x_2))=f(p(x_1))+f(p(x_2))$ ；

  5. 为满足推断公式，则定义 $f(p(x)):=-log_2p(x)$；

     - 由于 $log$ 单调递增，但当 $p(x)$ 越小所得到的信息量越大，即越不确定的事情发生所得到的信息量越大，故增加负号；

     - 为将所得数值以比特（byte）为单位，故 $log$ 以 2 为底，便于换算；

       如当计算机存储16位数据，在输入前任意结果概率为 $\frac{1}{2^{16}}$ ，当输入后概率为1，则信息量为16 byte；

### 定义熵

- 熵是衡量整个系统中所有事件的信息量，熵越大代表系统中事件的不确定性越高；

  如系统 $Z$ 事件 $a,b$ 发生的概率分别为 $50\%$ ，系统 $Y$ 中 $c,d$ 发生的概率分别为 $99\%,1\%$ ，当结果确定后系统 $Z$ 的不确定性高，所以熵越大；若单纯将信息量相加不满足规律，故需要进行加权运算；

  <table>
      <tr>
          <td>系统</td>
          <td colspan="2">$Z$</td>
          <td colspan="2">$Y$</td>
      </tr>
      <tr>
          <td>事件</td>
          <td>$a$</td>
          <td>$b$</td>
          <td>$c$</td>
          <td>$d$</td>
      </tr>
      <tr>
          <td>概率</td>
          <td>$\frac{1}{2}$</td>
          <td>$\frac{1}{2}$</td>
          <td>$\frac{99}{100}$</td>
          <td>$\frac{1}{100}$</td>
      </tr>
      <tr>
          <td>信息量</td>
          <td>$-log_2 \frac{1}{2} =1$</td>
          <td>$-log_2 \frac{1}{2} =1$</td>
          <td>$-log_2 \frac{99}{10}\approx 0.0145$</td>
          <td>$-log_2 \frac{1}{10}\approx 6.6439$</td>
      </tr>
      <tr>
          <td>对系统贡献信息量</td>
          <td>$\begin{align}frac{1}{2}*1 \newline =0.5\end{align}$</td>
          <td>$\begin{align}frac{1}{2}*1 \newline =0.5\end{align}$</td>
          <td>$\begin{align}\frac{99}{10}(-log_2 \frac{99}{10}) \newline \approx 0.014355\end{align}$</td>
          <td>$\begin{align}\frac{99}{10}(-log_2 \frac{1}{10}) \newline \approx 0.066439\end{align}$</td>
      </tr>
      <tr>
          <td>熵</td>
          <td colspan="2">$1$</td>
          <td colspan="2">$\approx 0.080794$</td>
      </tr>
  </table>

